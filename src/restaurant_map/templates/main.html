{% extends "/shared/_base.html" %}

{% if type == "both" %}
    {% set cols = "grid-cols-4" %}
    {% set list_cols = "grid-cols-1" %}
{% else %}
    {% set cols = "grid-cols-1" %}
    {% set list_cols = "grid-cols-4" %}
{% endif %}

{% block content %}
    <section id="body" class="flex flex-col bg-slate-50 justify-center items-center">
        <div class="flex flex-col justify-center items-center py-10 h-screen w-screen">
            {% if type == "both" %}
                <div class="grid {{ cols }} h-screen">
            {% endif %}
            {% if type in ["both", "list"] %}
                <span id="points-list" class="grid {{ list_cols }} gap-2 justify-start content-start text-center overflow-y-scroll">
                    {% block point_entry %}
                        {% for point in points %}
                        <button id="pt-{{point['properties']['id']}}" data-coords={{point["geometry"]["coordinates"]|join(',')}}
                             class="flex flex-col border-2 border-slate-900 focus:bg-violet-100 transition-colors ease-in-out rounded-lg content-center text-center h-auto">
                            <span class="py-1 uppercase font-bold">
                                {{point["properties"]["name"]}}
                                <img hx-get="/details/{{point['properties']['id']}}" hx-target="body" hx-swap="beforeend"
                                     class="inline" src="/static/images/akar-icons--info.svg"/>
                            </span>
                            <span class="py-1 px-1 text-sm text-slate-600">{{point["properties"]["address"]}}</span>
                            <div class="my-2 gap-1 flex flex-row flex-wrap justify-center">
                                {% for tag in point["properties"]["tags"] | sort %}
                                    <span class="p-2 whitespace-nowrap text-sm text-slate-200 rounded  {{tag|lower|replace(' ','-')}}">{{tag}}</span>
                                {% endfor %}
                            </div>
                            <span class="py-1 px-1 text-sm text-slate-600">{{point["properties"]["description"]}}</span>
                        </button>
                        {% endfor %}
                    {% endblock %}
                </span>
            {% endif %}
            {% if type in ["both", "map"] %}
                <span class="col-span-3 h-full w-full" id="map"></span>
                <script type="text/javascript" src="/static/javascript/map.js"> </script>
            {% endif %}
            {% if type == "map" %}
                {% for point in points %}
                    <div id="trigger-{{point['properties']['id']}}" hx-get="/details/{{point['properties']['id']}}"
                         hx-target="body" hx-trigger="detail-{{point['properties']['id']}} from:body" hx-swap="beforeend"></div>
                {% endfor %}
            {% endif %}
            {% if type == "both" %}
                </div>
            {% endif %}
        </div>
    </section>
{% endblock %}
